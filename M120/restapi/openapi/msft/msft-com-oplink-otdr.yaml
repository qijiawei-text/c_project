---
swagger: "2.0"
info:
  description: "YANG definitions for OTDR"
  version: "1.0"
  title: "com-oplink-otdr API"
host: "localhost:1234"
consumes:
- "application/yang-data+json"
produces:
- "application/yang-data+json"
paths:
  /data/optical-otdr/:
    get:
      tags:
      - "com-oplink-otdr"
      summary: "returns com.oplink.otdr.OtdrModule"
      description: "returns com.oplink.otdr.OtdrModule"
      parameters: []
      responses:
        200:
          description: "com.oplink.otdr.OtdrModule"
          schema:
            $ref: "#/definitions/com.oplink.otdr.OtdrModuleWrapper"
        400:
          description: "Internal error"
    post:
      tags:
      - "com-oplink-otdr"
      summary: "creates com.oplink.otdr.OtdrModule"
      description: "creates com.oplink.otdr.OtdrModule"
      parameters:
      - in: "body"
        name: "com.oplink.otdr.OtdrModule.body-param"
        description: "com.oplink.otdr.OtdrModule to be added to list"
        required: false
        schema:
          $ref: "#/definitions/com.oplink.otdr.OtdrModuleWrapper"
      responses:
        201:
          description: "Object created"
        400:
          description: "Internal error"
        409:
          description: "Object already exists"
    put:
      tags:
      - "com-oplink-otdr"
      summary: "creates or updates com.oplink.otdr.OtdrModule"
      description: "creates or updates com.oplink.otdr.OtdrModule"
      parameters:
      - in: "body"
        name: "com.oplink.otdr.OtdrModule.body-param"
        description: "com.oplink.otdr.OtdrModule to be added or updated"
        required: false
        schema:
          $ref: "#/definitions/com.oplink.otdr.OtdrModuleWrapper"
      responses:
        201:
          description: "Object created"
        400:
          description: "Internal error"
        204:
          description: "Object modified"
    delete:
      tags:
      - "com-oplink-otdr"
      summary: "removes com.oplink.otdr.OtdrModule"
      description: "removes com.oplink.otdr.OtdrModule"
      parameters: []
      responses:
        400:
          description: "Internal error"
        204:
          description: "Object deleted"
  /data/optical-otdr/config/:
    get:
      tags:
      - "com-oplink-otdr"
      summary: "returns com.oplink.otdr.otdrmodule.Config"
      description: "user configured, customized scan config"
      parameters: []
      responses:
        200:
          description: "com.oplink.otdr.otdrmodule.Config"
          schema:
            $ref: "#/definitions/com.oplink.otdr.otdrmodule.ConfigWrapper"
        400:
          description: "Internal error"
    post:
      tags:
      - "com-oplink-otdr"
      summary: "creates com.oplink.otdr.otdrmodule.Config"
      description: "user configured, customized scan config"
      parameters:
      - in: "body"
        name: "com.oplink.otdr.otdrmodule.Config.body-param"
        description: "com.oplink.otdr.otdrmodule.Config to be added to list"
        required: false
        schema:
          $ref: "#/definitions/com.oplink.otdr.otdrmodule.ConfigWrapper"
      responses:
        201:
          description: "Object created"
        400:
          description: "Internal error"
        409:
          description: "Object already exists"
    put:
      tags:
      - "com-oplink-otdr"
      summary: "creates or updates com.oplink.otdr.otdrmodule.Config"
      description: "user configured, customized scan config"
      parameters:
      - in: "body"
        name: "com.oplink.otdr.otdrmodule.Config.body-param"
        description: "com.oplink.otdr.otdrmodule.Config to be added or updated"
        required: false
        schema:
          $ref: "#/definitions/com.oplink.otdr.otdrmodule.ConfigWrapper"
      responses:
        201:
          description: "Object created"
        400:
          description: "Internal error"
        204:
          description: "Object modified"
    delete:
      tags:
      - "com-oplink-otdr"
      summary: "removes com.oplink.otdr.otdrmodule.Config"
      description: "user configured, customized scan config"
      parameters: []
      responses:
        400:
          description: "Internal error"
        204:
          description: "Object deleted"
  /data/optical-otdr/otdr-port/:
    post:
      tags:
      - "com-oplink-otdr"
      summary: "creates com.oplink.otdr.otdrmodule.OtdrPort"
      description: "creates com.oplink.otdr.otdrmodule.OtdrPort"
      parameters:
      - in: "body"
        name: "com.oplink.otdr.otdrmodule.OtdrPort.body-param"
        description: "com.oplink.otdr.otdrmodule.OtdrPort to be added to list"
        required: false
        schema:
          $ref: "#/definitions/com.oplink.otdr.otdrmodule.OtdrPortWrapper"
      responses:
        201:
          description: "Object created"
        400:
          description: "Internal error"
        409:
          description: "Object already exists"
  /data/optical-otdr/otdr-port={port-name}/:
    get:
      tags:
      - "com-oplink-otdr"
      summary: "returns com.oplink.otdr.otdrmodule.OtdrPort"
      description: "returns com.oplink.otdr.otdrmodule.OtdrPort"
      parameters:
      - name: "port-name"
        in: "path"
        description: "Id of otdr-port"
        required: true
        type: "string"
      responses:
        200:
          description: "com.oplink.otdr.otdrmodule.OtdrPort"
          schema:
            $ref: "#/definitions/com.oplink.otdr.otdrmodule.OtdrPortWrapper"
        400:
          description: "Internal error"
    put:
      tags:
      - "com-oplink-otdr"
      summary: "creates or updates com.oplink.otdr.otdrmodule.OtdrPort"
      description: "creates or updates com.oplink.otdr.otdrmodule.OtdrPort"
      parameters:
      - name: "port-name"
        in: "path"
        description: "Id of otdr-port"
        required: true
        type: "string"
      - in: "body"
        name: "com.oplink.otdr.otdrmodule.OtdrPort.body-param"
        description: "com.oplink.otdr.otdrmodule.OtdrPort to be added or updated"
        required: false
        schema:
          $ref: "#/definitions/com.oplink.otdr.otdrmodule.OtdrPortWrapper"
      responses:
        201:
          description: "Object created"
        400:
          description: "Internal error"
        204:
          description: "Object modified"
    delete:
      tags:
      - "com-oplink-otdr"
      summary: "removes com.oplink.otdr.otdrmodule.OtdrPort"
      description: "removes com.oplink.otdr.otdrmodule.OtdrPort"
      parameters:
      - name: "port-name"
        in: "path"
        description: "Id of otdr-port"
        required: true
        type: "string"
      responses:
        400:
          description: "Internal error"
        204:
          description: "Object deleted"
  /data/optical-otdr/otdr-port={port-name}/config/:
    get:
      tags:
      - "com-oplink-otdr"
      summary: "returns com.oplink.otdr.OtdrPortConfig"
      description: "returns com.oplink.otdr.OtdrPortConfig"
      parameters:
      - name: "port-name"
        in: "path"
        description: "Id of otdr-port"
        required: true
        type: "string"
      responses:
        200:
          description: "com.oplink.otdr.OtdrPortConfig"
          schema:
            $ref: "#/definitions/com.oplink.otdr.OtdrPortConfigWrapper"
        400:
          description: "Internal error"
    post:
      tags:
      - "com-oplink-otdr"
      summary: "creates com.oplink.otdr.OtdrPortConfig"
      description: "creates com.oplink.otdr.OtdrPortConfig"
      parameters:
      - name: "port-name"
        in: "path"
        description: "Id of otdr-port"
        required: true
        type: "string"
      - in: "body"
        name: "com.oplink.otdr.OtdrPortConfig.body-param"
        description: "com.oplink.otdr.OtdrPortConfig to be added to list"
        required: false
        schema:
          $ref: "#/definitions/com.oplink.otdr.OtdrPortConfigWrapper"
      responses:
        201:
          description: "Object created"
        400:
          description: "Internal error"
        409:
          description: "Object already exists"
    put:
      tags:
      - "com-oplink-otdr"
      summary: "creates or updates com.oplink.otdr.OtdrPortConfig"
      description: "creates or updates com.oplink.otdr.OtdrPortConfig"
      parameters:
      - name: "port-name"
        in: "path"
        description: "Id of otdr-port"
        required: true
        type: "string"
      - in: "body"
        name: "com.oplink.otdr.OtdrPortConfig.body-param"
        description: "com.oplink.otdr.OtdrPortConfig to be added or updated"
        required: false
        schema:
          $ref: "#/definitions/com.oplink.otdr.OtdrPortConfigWrapper"
      responses:
        201:
          description: "Object created"
        400:
          description: "Internal error"
        204:
          description: "Object modified"
    delete:
      tags:
      - "com-oplink-otdr"
      summary: "removes com.oplink.otdr.OtdrPortConfig"
      description: "removes com.oplink.otdr.OtdrPortConfig"
      parameters:
      - name: "port-name"
        in: "path"
        description: "Id of otdr-port"
        required: true
        type: "string"
      responses:
        400:
          description: "Internal error"
        204:
          description: "Object deleted"
  /data/optical-otdr/otdr-port={port-name}/state/:
    get:
      tags:
      - "com-oplink-otdr"
      summary: "returns com.oplink.otdr.OtdrPortState"
      description: "returns com.oplink.otdr.OtdrPortState"
      parameters:
      - name: "port-name"
        in: "path"
        description: "Id of otdr-port"
        required: true
        type: "string"
      responses:
        200:
          description: "com.oplink.otdr.OtdrPortState"
          schema:
            $ref: "#/definitions/com.oplink.otdr.OtdrPortStateWrapper"
        400:
          description: "Internal error"
  /data/optical-otdr/otdr-port={port-name}/state/otdr-event={event-id}/:
    get:
      tags:
      - "com-oplink-otdr"
      summary: "returns com.oplink.otdr.otdrscanresult.OtdrEvent"
      description: "List of detected events, 0..99."
      parameters:
      - name: "port-name"
        in: "path"
        description: "Id of otdr-port"
        required: true
        type: "string"
      - name: "event-id"
        in: "path"
        description: "Id of otdr-event"
        required: true
        type: "integer"
        format: "int64"
      responses:
        200:
          description: "com.oplink.otdr.otdrscanresult.OtdrEvent"
          schema:
            $ref: "#/definitions/com.oplink.otdr.otdrscanresult.OtdrEventWrapper"
        400:
          description: "Internal error"
  /data/optical-otdr/pre-config={scan-type}/:
    get:
      tags:
      - "com-oplink-otdr"
      summary: "returns com.oplink.otdr.OtdrScanConfig"
      description: "pre-defined scan config"
      parameters:
      - name: "scan-type"
        in: "path"
        description: "Id of pre-config"
        required: true
        type: "string"
      responses:
        200:
          description: "com.oplink.otdr.OtdrScanConfig"
          schema:
            $ref: "#/definitions/com.oplink.otdr.OtdrScanConfigWrapper"
        400:
          description: "Internal error"
  /data/optical-otdr/state/:
    get:
      tags:
      - "com-oplink-otdr"
      summary: "returns com.oplink.otdr.OtdrModuleState"
      description: "returns com.oplink.otdr.OtdrModuleState"
      parameters: []
      responses:
        200:
          description: "com.oplink.otdr.OtdrModuleState"
          schema:
            $ref: "#/definitions/com.oplink.otdr.OtdrModuleStateWrapper"
        400:
          description: "Internal error"
  /operations/otdr-scan/:
    post:
      tags:
      - "com-oplink-otdr"
      summary: "operates on com.oplink.otdr.OtdrScan"
      description: "operates on com.oplink.otdr.OtdrScan"
      parameters:
      - in: "body"
        name: "com.oplink.otdr.otdrscan.Input.body-param"
        required: false
        schema:
          properties:
            input:
              $ref: "#/definitions/com.oplink.otdr.otdrscan.Input"
      responses:
        200:
          description: "Correct response"
          schema:
            $ref: "#/definitions/com.oplink.otdr.OtdrScan"
        201:
          description: "No response"
        400:
          description: "Internal error"
  /operations/trace-baseline/:
    post:
      tags:
      - "com-oplink-otdr"
      summary: "operates on com.oplink.otdr.TraceBaseline"
      description: "operates on com.oplink.otdr.TraceBaseline"
      parameters:
      - in: "body"
        name: "com.oplink.otdr.tracebaseline.Input.body-param"
        required: false
        schema:
          properties:
            input:
              $ref: "#/definitions/com.oplink.otdr.tracebaseline.Input"
      responses:
        200:
          description: "Correct response"
          schema:
            $ref: "#/definitions/com.oplink.otdr.TraceBaseline"
        201:
          description: "No response"
        400:
          description: "Internal error"
  /data/optical-otdr/sor-files/:
    get:
      tags:
      - "com-oplink-otdr"
      summary: "returns com.oplink.otdr.otdrmodule.sor.files"
      description: "sor files or baseline sor files"
      parameters: []
      responses:
        200:
          description: "com.oplink.otdr.otdrmodule.sor.files"
          schema:
            $ref: "#/definitions/com.oplink.otdr.otdrmodule.sorfiles"
        400:
          description: "Internal error"
definitions:
  com.oplink.otdr.EventTypeEnumeration:
    type: "string"
    enum:
    - "non-reflective"
    - "reflective"
    - "fiber-end"
  com.oplink.otdr.Operation:
    type: "string"
    enum:
    - "start"
    - "stop"
  com.oplink.otdr.OtdrMode:
    type: "string"
    enum:
    - "measuring"
    - "idle"
  com.oplink.otdr.OtdrModule:
    type: "object"
    properties:
      otdr-port:
        type: "array"
        items:
          $ref: "#/definitions/com.oplink.otdr.otdrmodule.OtdrPort"
      state:
        $ref: "#/definitions/com.oplink.otdr.OtdrModuleState"
      pre-config:
        type: "array"
        description: "pre-defined scan config"
        items:
          $ref: "#/definitions/com.oplink.otdr.OtdrScanConfig"
      config:
        description: "user configured, customized scan config"
        $ref: "#/definitions/com.oplink.otdr.otdrmodule.Config"
  com.oplink.otdr.OtdrModuleState:
    type: "object"
    properties:
      otdr-mode:
        description: "Indicates which mode OTDR is in."
        $ref: "#/definitions/com.oplink.otdr.OtdrMode"
  com.oplink.otdr.OtdrModuleStateWrapper:
    properties:
      state:
        $ref: "#/definitions/com.oplink.otdr.OtdrModuleState"
  com.oplink.otdr.OtdrModuleWrapper:
    properties:
      optical-otdr:
        $ref: "#/definitions/com.oplink.otdr.OtdrModule"
  com.oplink.otdr.OtdrPortConfig:
    type: "object"
    properties:
      launch-cable-length:
        type: "integer"
        format: "int64"
        default: 30
      port-name:
        type: "string"
        description: "Reference to EDFA line port"
  com.oplink.otdr.OtdrPortConfigWrapper:
    properties:
      config:
        $ref: "#/definitions/com.oplink.otdr.OtdrPortConfig"
  com.oplink.otdr.OtdrPortState:
    allOf:
    - $ref: "#/definitions/com.oplink.otdr.OtdrScanResult"
    - type: "object"
      properties:
        otdr-mode:
          description: "Measuring or idle"
          $ref: "#/definitions/com.oplink.otdr.OtdrMode"
  com.oplink.otdr.OtdrPortStateWrapper:
    properties:
      state:
        $ref: "#/definitions/com.oplink.otdr.OtdrPortState"
  com.oplink.otdr.OtdrScan:
    type: "object"
    properties:
      output:
        $ref: "#/definitions/org.openroadm.common.types.ExtendedRpcResponseStatus"
  com.oplink.otdr.OtdrScanConfig:
    allOf:
    - $ref: "#/definitions/com.oplink.otdr.OtdrScanPara"
    - $ref: "#/definitions/com.oplink.otdr.OtdrScanType"
    - $ref: "#/definitions/com.oplink.otdr.OtdrThr"
  com.oplink.otdr.OtdrScanConfigWrapper:
    properties:
      pre-config:
        $ref: "#/definitions/com.oplink.otdr.OtdrScanConfig"
  com.oplink.otdr.OtdrScanData:
    type: "object"
    properties:
      loss:
        type: "string"
        description: "Power loss."
      fiber-length:
        type: "integer"
        format: "int64"
        description: "Fiber length/location."
      reflectance:
        type: "string"
        description: "Reflection."
  com.oplink.otdr.OtdrScanPara:
    type: "object"
    properties:
      pulse-width:
        type: "integer"
        format: "int64"
        description: "Scan pulse width."
      sample-resolution:
        type: "string"
        description: "Sampling resolution."
      measuring-time:
        type: "integer"
        format: "int64"
        description: "Scan measuring time."
      user-ior:
        type: "string"
        description: "User IOR (Index of Refraction) limit."
      distance-range:
        type: "integer"
        format: "int64"
        description: "Scan distance range."
  com.oplink.otdr.OtdrScanResult:
    allOf:
    - $ref: "#/definitions/com.oplink.otdr.OtdrScanData"
    - type: "object"
      properties:
        completion-time:
          type: "string"
          description: "Time scan was completed."
        event-count:
          type: "integer"
          format: "int64"
          description: "Count of the event."
        otdr-event:
          type: "array"
          description: "List of detected events, 0..99."
          items:
            $ref: "#/definitions/com.oplink.otdr.otdrscanresult.OtdrEvent"
        port-name:
          type: "string"
  com.oplink.otdr.OtdrScanTrigger:
    type: "object"
    properties:
      event-trigger:
        type: "boolean"
        description: "enable/disable event-driven scan, based on LOS or spanloss change\
          \ alarm."
        default: false
      interval:
        type: "integer"
        format: "int64"
        description: "interval for periodical scan, set 0 to disable it."
        default: 0
  com.oplink.otdr.OtdrScanType:
    type: "object"
    properties:
      scan-type:
        description: "A set of otdr scan configuration."
        $ref: "#/definitions/com.oplink.otdr.ScanTypeEnumeration"
  com.oplink.otdr.OtdrThr:
    type: "object"
    properties:
      reflectance-thr:
        type: "string"
      fiber-end-thr:
        type: "string"
      splice-loss-thr:
        type: "string"
  com.oplink.otdr.ScanTypeEnumeration:
    type: "string"
    enum:
    - "customized"
    - "short"
    - "medium"
    - "long"
    - "all"
  com.oplink.otdr.TraceBaseline:
    type: "object"
    properties:
      output:
        $ref: "#/definitions/com.oplink.otdr.tracebaseline.Output"
  com.oplink.otdr.otdrmodule.Config:
    allOf:
    - $ref: "#/definitions/com.oplink.otdr.OtdrScanConfig"
    - $ref: "#/definitions/com.oplink.otdr.OtdrScanTrigger"
  com.oplink.otdr.otdrmodule.ConfigWrapper:
    properties:
      config:
        $ref: "#/definitions/com.oplink.otdr.otdrmodule.Config"
  com.oplink.otdr.otdrmodule.OtdrPort:
    type: "object"
    properties:
      state:
        $ref: "#/definitions/com.oplink.otdr.OtdrPortState"
      config:
        $ref: "#/definitions/com.oplink.otdr.OtdrPortConfig"
      port-name:
        type: "string"
        description: "Reference to the name of the port"
        x-path: "../config/port-name"
  com.oplink.otdr.otdrmodule.OtdrPortWrapper:
    properties:
      otdr-port:
        $ref: "#/definitions/com.oplink.otdr.otdrmodule.OtdrPort"
  com.oplink.otdr.otdrscan.Input:
    allOf:
    - $ref: "#/definitions/com.oplink.otdr.OtdrScanType"
    - type: "object"
      properties:
        operation:
          $ref: "#/definitions/com.oplink.otdr.Operation"
        port-name:
          type: "string"
          description: "The choice describes the option to specify the entity for\
            \ the start-scan RPC. 'ALL' for scanning all ports."
  com.oplink.otdr.otdrscanresult.OtdrEvent:
    allOf:
    - $ref: "#/definitions/com.oplink.otdr.OtdrScanData"
    - type: "object"
      properties:
        total-loss:
          type: "string"
          description: "Total power loss up to this event."
        event-id:
          type: "integer"
          format: "int64"
        event-type:
          description: "Indicates which event is detected."
          $ref: "#/definitions/com.oplink.otdr.EventTypeEnumeration"
      description: "List of detected events, 0..99."
  com.oplink.otdr.otdrscanresult.OtdrEventWrapper:
    properties:
      otdr-event:
        $ref: "#/definitions/com.oplink.otdr.otdrscanresult.OtdrEvent"
  com.oplink.otdr.tracebaseline.Input:
    type: "object"
    properties:
      operation:
        description: "The operation to use."
        $ref: "#/definitions/com.oplink.otdr.Operation"
  com.oplink.otdr.tracebaseline.Output:
    allOf:
    - $ref: "#/definitions/org.openroadm.common.types.RpcResponseStatus"
    - type: "object"
      properties:
        result-file:
          type: "array"
          description: "The SOR files path and filename on the device to be downloaded"
          items:
            type: "string"
  org.openroadm.common.types.ExtendedRpcResponseStatus:
    type: "object"
    properties:
      status-message:
        type: "string"
        description: "Gives a more detailed status."
      status:
        description: "Successful, Failed or In-progress"
        $ref: "#/definitions/org.openroadm.common.types.ExtendedRpcStatus"
  org.openroadm.common.types.ExtendedRpcStatus:
    type: "string"
    enum:
    - "Successful"
    - "Failed"
    - "In-progress"
  org.openroadm.common.types.RpcResponseStatus:
    type: "object"
    properties:
      status-message:
        type: "string"
        description: "Gives a more detailed status"
      status:
        description: "Successful or Failed"
        $ref: "#/definitions/org.openroadm.common.types.RpcStatus"
  org.openroadm.common.types.RpcStatus:
    type: "string"
    enum:
    - "Successful"
    - "Failed"
  com.oplink.otdr.otdrmodule.sorfiles:
    type: "object"
    properties:
      file:
        type: "array"
        description: "sor file list"
        items:
          $ref: "#/definitions/com.oplink.otdr.otdrmodule.sorfiles.file"
  com.oplink.otdr.otdrmodule.sorfiles.file:
    type: "object"
    properties:
      filename:
        type: "string"
        description: "sor filename"
      filesize:
        type: "string"
        description: "sor file size"
      modified-date:
        type: "string"
        description: "sor modified date"
